(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[0],{

/***/ "../pkg/wasm_boids.js":
/*!****************************!*\
  !*** ../pkg/wasm_boids.js ***!
  \****************************/
/*! exports provided: Boid, Flock, __wbg_boid_new, __wbindgen_object_drop_ref, __wbg_new_1abc33d4f9ba3e80, __wbg_push_44968dcdf4cfbb43, __wbg_cos_f478f20c5512be25, __wbg_random_eb1fab8e1db2d9d1, __wbg_sin_c226789c5813e9c2, __wbindgen_throw */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _wasm_boids_bg_wasm__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./wasm_boids_bg.wasm */ \"../pkg/wasm_boids_bg.wasm\");\n/* harmony import */ var _wasm_boids_bg_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./wasm_boids_bg.js */ \"../pkg/wasm_boids_bg.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Boid\", function() { return _wasm_boids_bg_js__WEBPACK_IMPORTED_MODULE_1__[\"Boid\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Flock\", function() { return _wasm_boids_bg_js__WEBPACK_IMPORTED_MODULE_1__[\"Flock\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"__wbg_boid_new\", function() { return _wasm_boids_bg_js__WEBPACK_IMPORTED_MODULE_1__[\"__wbg_boid_new\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"__wbindgen_object_drop_ref\", function() { return _wasm_boids_bg_js__WEBPACK_IMPORTED_MODULE_1__[\"__wbindgen_object_drop_ref\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"__wbg_new_1abc33d4f9ba3e80\", function() { return _wasm_boids_bg_js__WEBPACK_IMPORTED_MODULE_1__[\"__wbg_new_1abc33d4f9ba3e80\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"__wbg_push_44968dcdf4cfbb43\", function() { return _wasm_boids_bg_js__WEBPACK_IMPORTED_MODULE_1__[\"__wbg_push_44968dcdf4cfbb43\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"__wbg_cos_f478f20c5512be25\", function() { return _wasm_boids_bg_js__WEBPACK_IMPORTED_MODULE_1__[\"__wbg_cos_f478f20c5512be25\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"__wbg_random_eb1fab8e1db2d9d1\", function() { return _wasm_boids_bg_js__WEBPACK_IMPORTED_MODULE_1__[\"__wbg_random_eb1fab8e1db2d9d1\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"__wbg_sin_c226789c5813e9c2\", function() { return _wasm_boids_bg_js__WEBPACK_IMPORTED_MODULE_1__[\"__wbg_sin_c226789c5813e9c2\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"__wbindgen_throw\", function() { return _wasm_boids_bg_js__WEBPACK_IMPORTED_MODULE_1__[\"__wbindgen_throw\"]; });\n\n\n\n\n//# sourceURL=webpack:///../pkg/wasm_boids.js?");

/***/ }),

/***/ "../pkg/wasm_boids_bg.js":
/*!*******************************!*\
  !*** ../pkg/wasm_boids_bg.js ***!
  \*******************************/
/*! exports provided: Boid, Flock, __wbg_boid_new, __wbindgen_object_drop_ref, __wbg_new_1abc33d4f9ba3e80, __wbg_push_44968dcdf4cfbb43, __wbg_cos_f478f20c5512be25, __wbg_random_eb1fab8e1db2d9d1, __wbg_sin_c226789c5813e9c2, __wbindgen_throw */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* WEBPACK VAR INJECTION */(function(module) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Boid\", function() { return Boid; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Flock\", function() { return Flock; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"__wbg_boid_new\", function() { return __wbg_boid_new; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"__wbindgen_object_drop_ref\", function() { return __wbindgen_object_drop_ref; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"__wbg_new_1abc33d4f9ba3e80\", function() { return __wbg_new_1abc33d4f9ba3e80; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"__wbg_push_44968dcdf4cfbb43\", function() { return __wbg_push_44968dcdf4cfbb43; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"__wbg_cos_f478f20c5512be25\", function() { return __wbg_cos_f478f20c5512be25; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"__wbg_random_eb1fab8e1db2d9d1\", function() { return __wbg_random_eb1fab8e1db2d9d1; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"__wbg_sin_c226789c5813e9c2\", function() { return __wbg_sin_c226789c5813e9c2; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"__wbindgen_throw\", function() { return __wbindgen_throw; });\n/* harmony import */ var _wasm_boids_bg_wasm__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./wasm_boids_bg.wasm */ \"../pkg/wasm_boids_bg.wasm\");\n\n\nconst heap = new Array(32).fill(undefined);\n\nheap.push(undefined, null, true, false);\n\nfunction getObject(idx) { return heap[idx]; }\n\nlet heap_next = heap.length;\n\nfunction dropObject(idx) {\n    if (idx < 36) return;\n    heap[idx] = heap_next;\n    heap_next = idx;\n}\n\nfunction takeObject(idx) {\n    const ret = getObject(idx);\n    dropObject(idx);\n    return ret;\n}\n\nconst lTextDecoder = typeof TextDecoder === 'undefined' ? (0, module.require)('util').TextDecoder : TextDecoder;\n\nlet cachedTextDecoder = new lTextDecoder('utf-8', { ignoreBOM: true, fatal: true });\n\ncachedTextDecoder.decode();\n\nlet cachegetUint8Memory0 = null;\nfunction getUint8Memory0() {\n    if (cachegetUint8Memory0 === null || cachegetUint8Memory0.buffer !== _wasm_boids_bg_wasm__WEBPACK_IMPORTED_MODULE_0__[\"memory\"].buffer) {\n        cachegetUint8Memory0 = new Uint8Array(_wasm_boids_bg_wasm__WEBPACK_IMPORTED_MODULE_0__[\"memory\"].buffer);\n    }\n    return cachegetUint8Memory0;\n}\n\nfunction getStringFromWasm0(ptr, len) {\n    return cachedTextDecoder.decode(getUint8Memory0().subarray(ptr, ptr + len));\n}\n\nfunction addHeapObject(obj) {\n    if (heap_next === heap.length) heap.push(heap.length + 1);\n    const idx = heap_next;\n    heap_next = heap[idx];\n\n    heap[idx] = obj;\n    return idx;\n}\n\nfunction notDefined(what) { return () => { throw new Error(`${what} is not defined`); }; }\n/**\n*/\nclass Boid {\n\n    static __wrap(ptr) {\n        const obj = Object.create(Boid.prototype);\n        obj.ptr = ptr;\n\n        return obj;\n    }\n\n    free() {\n        const ptr = this.ptr;\n        this.ptr = 0;\n\n        _wasm_boids_bg_wasm__WEBPACK_IMPORTED_MODULE_0__[\"__wbg_boid_free\"](ptr);\n    }\n    /**\n    * @returns {number}\n    */\n    get_x() {\n        var ret = _wasm_boids_bg_wasm__WEBPACK_IMPORTED_MODULE_0__[\"boid_get_x\"](this.ptr);\n        return ret;\n    }\n    /**\n    * @returns {number}\n    */\n    get_y() {\n        var ret = _wasm_boids_bg_wasm__WEBPACK_IMPORTED_MODULE_0__[\"boid_get_y\"](this.ptr);\n        return ret;\n    }\n    /**\n    * @returns {number}\n    */\n    get_angle() {\n        var ret = _wasm_boids_bg_wasm__WEBPACK_IMPORTED_MODULE_0__[\"boid_get_angle\"](this.ptr);\n        return ret;\n    }\n}\n/**\n*/\nclass Flock {\n\n    static __wrap(ptr) {\n        const obj = Object.create(Flock.prototype);\n        obj.ptr = ptr;\n\n        return obj;\n    }\n\n    free() {\n        const ptr = this.ptr;\n        this.ptr = 0;\n\n        _wasm_boids_bg_wasm__WEBPACK_IMPORTED_MODULE_0__[\"__wbg_flock_free\"](ptr);\n    }\n    /**\n    * @param {number} width\n    * @param {number} height\n    * @param {number} count\n    * @param {number} radius\n    * @param {number} max_speed\n    * @param {number} max_force\n    * @param {number} desired_separation\n    * @param {number} neighbor_distance\n    * @returns {Flock}\n    */\n    static new(width, height, count, radius, max_speed, max_force, desired_separation, neighbor_distance) {\n        var ret = _wasm_boids_bg_wasm__WEBPACK_IMPORTED_MODULE_0__[\"flock_new\"](width, height, count, radius, max_speed, max_force, desired_separation, neighbor_distance);\n        return Flock.__wrap(ret);\n    }\n    /**\n    * @returns {Array<any>}\n    */\n    boid_array() {\n        var ret = _wasm_boids_bg_wasm__WEBPACK_IMPORTED_MODULE_0__[\"flock_boid_array\"](this.ptr);\n        return takeObject(ret);\n    }\n    /**\n    */\n    tick() {\n        _wasm_boids_bg_wasm__WEBPACK_IMPORTED_MODULE_0__[\"flock_tick\"](this.ptr);\n    }\n    /**\n    * @param {number} width\n    * @param {number} height\n    */\n    set_size(width, height) {\n        _wasm_boids_bg_wasm__WEBPACK_IMPORTED_MODULE_0__[\"flock_set_size\"](this.ptr, width, height);\n    }\n    /**\n    */\n    flock() {\n        _wasm_boids_bg_wasm__WEBPACK_IMPORTED_MODULE_0__[\"flock_flock\"](this.ptr);\n    }\n    /**\n    */\n    update() {\n        _wasm_boids_bg_wasm__WEBPACK_IMPORTED_MODULE_0__[\"flock_update\"](this.ptr);\n    }\n    /**\n    */\n    wrap_around() {\n        _wasm_boids_bg_wasm__WEBPACK_IMPORTED_MODULE_0__[\"flock_wrap_around\"](this.ptr);\n    }\n}\n\nconst __wbg_boid_new = function(arg0) {\n    var ret = Boid.__wrap(arg0);\n    return addHeapObject(ret);\n};\n\nconst __wbindgen_object_drop_ref = function(arg0) {\n    takeObject(arg0);\n};\n\nconst __wbg_new_1abc33d4f9ba3e80 = function() {\n    var ret = new Array();\n    return addHeapObject(ret);\n};\n\nconst __wbg_push_44968dcdf4cfbb43 = function(arg0, arg1) {\n    var ret = getObject(arg0).push(getObject(arg1));\n    return ret;\n};\n\nconst __wbg_cos_f478f20c5512be25 = typeof Math.cos == 'function' ? Math.cos : notDefined('Math.cos');\n\nconst __wbg_random_eb1fab8e1db2d9d1 = typeof Math.random == 'function' ? Math.random : notDefined('Math.random');\n\nconst __wbg_sin_c226789c5813e9c2 = typeof Math.sin == 'function' ? Math.sin : notDefined('Math.sin');\n\nconst __wbindgen_throw = function(arg0, arg1) {\n    throw new Error(getStringFromWasm0(arg0, arg1));\n};\n\n\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../www/node_modules/webpack/buildin/harmony-module.js */ \"./node_modules/webpack/buildin/harmony-module.js\")(module)))\n\n//# sourceURL=webpack:///../pkg/wasm_boids_bg.js?");

/***/ }),

/***/ "../pkg/wasm_boids_bg.wasm":
/*!*********************************!*\
  !*** ../pkg/wasm_boids_bg.wasm ***!
  \*********************************/
/*! exports provided: memory, __wbg_flock_free, flock_new, flock_boid_array, flock_tick, flock_set_size, flock_flock, flock_update, flock_wrap_around, __wbg_boid_free, boid_get_x, boid_get_y, boid_get_angle */
/***/ (function(module, exports, __webpack_require__) {

eval("\"use strict\";\n// Instantiate WebAssembly module\nvar wasmExports = __webpack_require__.w[module.i];\n__webpack_require__.r(exports);\n// export exports from WebAssembly module\nfor(var name in wasmExports) if(name != \"__webpack_init__\") exports[name] = wasmExports[name];\n// exec imports from WebAssembly module (for esm order)\n/* harmony import */ var m0 = __webpack_require__(/*! ./wasm_boids_bg.js */ \"../pkg/wasm_boids_bg.js\");\n\n\n// exec wasm module\nwasmExports[\"__webpack_init__\"]()\n\n//# sourceURL=webpack:///../pkg/wasm_boids_bg.wasm?");

/***/ }),

/***/ "./index.js":
/*!******************!*\
  !*** ./index.js ***!
  \******************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var wasm_boids__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! wasm-boids */ \"../pkg/wasm_boids.js\");\n/* harmony import */ var _shaders_simple_vertex_glsl__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./shaders/simple-vertex.glsl */ \"./shaders/simple-vertex.glsl\");\n/* harmony import */ var _shaders_simple_vertex_glsl__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_shaders_simple_vertex_glsl__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _shaders_simple_fragment_glsl__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./shaders/simple-fragment.glsl */ \"./shaders/simple-fragment.glsl\");\n/* harmony import */ var _shaders_simple_fragment_glsl__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_shaders_simple_fragment_glsl__WEBPACK_IMPORTED_MODULE_2__);\n\n// import { memory } from 'wasm-boids/wasm_boids_bg';\n\n\n\nlet gl, canvas, ext;\n// const fixedDelta = 1/60.0;\n\nconst shapeScale = 15;\nconst numVertices = 6;\nconst boidCount = 500;\n\nconst maxSpeed = 2.0; // 2.0\nconst maxForce = 0.03; // 0.03\nconst desiredSeparation = 30.0; // 25\nconst neighborDistance =  60.0; // 50\n\nlet positionLoc, matrixLoc, projectionLoc;\nlet program;\nlet positionBuffer, matrixBuffer;\nconst matrices = [];\nconst matrixData = new Float32Array(boidCount * 16);\n\nlet flock;\n\nlet resizeHandle = null;\nlet resizeDebounce = 500;\n\nconst positions = [\n  0,  0.5,\n  0.4, -0.5,\n  0, -0.35,\n  0,  0.5,\n  0, -0.35,\n  -0.4, -0.5,\n].map(x => x * shapeScale);\n\nconst init = () => {\n  canvas = document.getElementById('boids-canvas');\n  gl = canvas.getContext('webgl');\n  if (!gl) {\n    console.error('webgl not available');\n    return false; \n  }\n\n  ext = gl.getExtension('ANGLE_instanced_arrays');\n  if (!ext) {\n    console.error('ANGLE_instanced_arrays not available');\n    return false;\n  }\n\n  resize();\n  \n  program = webglUtils.createProgramFromSources(gl, [\n    _shaders_simple_vertex_glsl__WEBPACK_IMPORTED_MODULE_1___default.a,\n    _shaders_simple_fragment_glsl__WEBPACK_IMPORTED_MODULE_2___default.a,\n  ]);\n\n  positionLoc = gl.getAttribLocation(program, 'a_position');\n  matrixLoc = gl.getAttribLocation(program, 'matrix');\n  projectionLoc = gl.getUniformLocation(program, 'projection');\n\n  positionBuffer = gl.createBuffer();\n  gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);\n  gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(positions), gl.STATIC_DRAW);\n  \n  // setup matrixes, one per instance\n  // make a typed array with one view per matrix\n  for (let i = 0; i < boidCount; ++i) {\n    const byteOffsetToMatrix = i * 16 * 4;\n    const numFloatsForView = 16;\n    matrices.push(new Float32Array(\n        matrixData.buffer,\n        byteOffsetToMatrix,\n        numFloatsForView));\n  }\n\n  matrixBuffer = gl.createBuffer();\n  gl.bindBuffer(gl.ARRAY_BUFFER, matrixBuffer);\n  gl.bufferData(gl.ARRAY_BUFFER, matrixData.byteLength, gl.DYNAMIC_DRAW);\n\n  flock = wasm_boids__WEBPACK_IMPORTED_MODULE_0__[\"Flock\"].new(\n    gl.canvas.width,\n    gl.canvas.height,\n    boidCount,\n    shapeScale * 0.5,\n    maxSpeed,\n    maxForce,\n    desiredSeparation,\n    neighborDistance,\n  );\n  \n  return true;\n}\n\nconst update = (time) => {\n  flock.tick();\n  render(time);\n  requestAnimationFrame(update);\n}\n\nconst render = (time) => {\n  const boids = flock.boid_array();\n\n  gl.clearColor(75/255.0, 68/255.0, 83/255.0, 1);\n  gl.clear(gl.COLOR_BUFFER_BIT);\n\n  gl.useProgram(program);\n\n  var projectionMatrix = m4.orthographic(0, gl.canvas.clientWidth, 0, gl.canvas.clientHeight, -1, 1);\n  gl.uniformMatrix4fv(projectionLoc, false,  projectionMatrix);\n\n  gl.enableVertexAttribArray(positionLoc);\n  gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);\n  gl.vertexAttribPointer(positionLoc, 2, gl.FLOAT, false, 0, 0);\n\n  // update all the matrices\n  matrices.forEach((mat, i) => {\n    m4.translation(boids[i].get_x(), boids[i].get_y(), 0, mat);\n    m4.zRotate(mat, boids[i].get_angle(), mat);\n  });\n\n  // upload the new matrix data\n  gl.bindBuffer(gl.ARRAY_BUFFER, matrixBuffer);\n  gl.bufferSubData(gl.ARRAY_BUFFER, 0, matrixData);\n\n  // set all 4 attributes for matrix\n  const bytesPerMatrix = 4 * 16;\n  for (let i = 0; i < 4; ++i) {\n    const loc = matrixLoc + i;\n    gl.enableVertexAttribArray(loc);\n    // note the stride and offset\n    const offset = i * 16;  // 4 floats per row, 4 bytes per float\n    gl.vertexAttribPointer(\n        loc,              // location\n        4,                // size (num values to pull from buffer per iteration)\n        gl.FLOAT,         // type of data in buffer\n        false,            // normalize\n        bytesPerMatrix,   // stride, num bytes to advance to get to next set of values\n        offset,           // offset in buffer\n    );\n    // this line says this attribute only changes for each 1 instance\n    ext.vertexAttribDivisorANGLE(loc, 1);\n  }\n\n  ext.drawArraysInstancedANGLE(\n    gl.TRIANGLES,\n    0,             // offset\n    numVertices,   // num vertices per instance\n    boidCount,  // num instances\n  );\n}\n\nconst resize = () => {\n  webglUtils.resizeCanvasToDisplaySize(gl.canvas);\n  gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);\n  if(flock) {\n    flock.set_size(gl.canvas.width, gl.canvas.height);\n  }\n}\n\nif(init()) {\n  resize();\n  requestAnimationFrame(update);\n\n  window.onresize = (event) => {\n    clearTimeout(resizeHandle);\n    resizeHandle = setTimeout(resize, resizeDebounce);\n  };\n}\n\n//# sourceURL=webpack:///./index.js?");

/***/ }),

/***/ "./node_modules/webpack/buildin/harmony-module.js":
/*!*******************************************!*\
  !*** (webpack)/buildin/harmony-module.js ***!
  \*******************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = function(originalModule) {\n\tif (!originalModule.webpackPolyfill) {\n\t\tvar module = Object.create(originalModule);\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"exports\", {\n\t\t\tenumerable: true\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n\n\n//# sourceURL=webpack:///(webpack)/buildin/harmony-module.js?");

/***/ }),

/***/ "./shaders/simple-fragment.glsl":
/*!**************************************!*\
  !*** ./shaders/simple-fragment.glsl ***!
  \**************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = \"precision mediump float;\\n\\nvoid main() {\\n  gl_FragColor = vec4(0.92156862745, 0.25098039215, 0.20392156862, 1.0);\\n}\"\n\n//# sourceURL=webpack:///./shaders/simple-fragment.glsl?");

/***/ }),

/***/ "./shaders/simple-vertex.glsl":
/*!************************************!*\
  !*** ./shaders/simple-vertex.glsl ***!
  \************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = \"attribute vec4 a_position;\\nattribute mat4 matrix;\\nuniform mat4 projection;\\n\\nvoid main() {\\n  gl_Position = projection * matrix * a_position;\\n}\"\n\n//# sourceURL=webpack:///./shaders/simple-vertex.glsl?");

/***/ })

}]);